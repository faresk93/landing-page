<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fares KHIARY</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë®‚Äçüíª</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; touch-action: none; }

        /* UI Animations */
        .fade-out { opacity: 0; pointer-events: none; transform: scale(0.95); filter: blur(10px); }
        .ui-transition { transition: all 1s cubic-bezier(0.16, 1, 0.3, 1); }

        /* Construction Banner - Restored */
        .construction-banner {
            background: linear-gradient(135deg, rgba(255, 165, 0, 0.15) 0%, rgba(255, 100, 0, 0.15) 100%);
            border: 2px solid rgba(255, 165, 0, 0.5);
            animation: banner-glow 2s ease-in-out infinite alternate;
            position: relative;
            overflow: hidden;
        }
        @keyframes banner-glow {
            0% { box-shadow: 0 0 10px rgba(255, 165, 0, 0.3), inset 0 0 20px rgba(255, 165, 0, 0.1); }
            100% { box-shadow: 0 0 25px rgba(255, 165, 0, 0.6), inset 0 0 30px rgba(255, 165, 0, 0.2); }
        }

        .construction-icon {
            display: inline-block;
            animation: icon-bounce 1s ease-in-out infinite;
        }
        @keyframes icon-bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-5px) scale(1.05); }
        }

        .gear-spin {
            display: inline-block;
            animation: gear-rotate 3s linear infinite;
        }
        @keyframes gear-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Glitch Text - Enhanced */
        .glitch {
            position: relative;
            color: white;
            mix-blend-mode: lighten;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5), 0 0 60px rgba(168, 85, 247, 0.3);
        }
        .glitch::before, .glitch::after {
            content: attr(data-text); position: absolute; top: 0; width: 100%; height: 100%; opacity: 0.8;
        }
        .glitch::before {
            left: 2px; color: #0ff; clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
            animation: glitch-anim-1 2.5s infinite linear alternate-reverse;
        }
        .glitch::after {
            left: -2px; color: #f0f; clip-path: polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim-1 { 0% { transform: translate(0); } 20% { transform: translate(-2px, 2px); } 100% { transform: translate(1px, -1px); } }
        @keyframes glitch-anim-2 { 0% { transform: translate(0); } 20% { transform: translate(2px, -2px); } 100% { transform: translate(-1px, 1px); } }

        /* Scanning Line */
        .scanline {
            width: 100%; height: 2px; background: rgba(0, 255, 255, 0.3);
            position: absolute; top: 0; left: 0;
            animation: scan 3s infinite linear;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        @keyframes scan { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        #interactive-hint { opacity: 0; transition: opacity 1s; }
        .show-hint { opacity: 1 !important; }

        /* Enhanced Greeting Animations with Zoom */
        .greeting-word {
            opacity: 0;
            position: absolute;
            font-size: 1rem;
            font-weight: 700;
            background: linear-gradient(45deg, #00f5ff, #a855f7, #ec4899, #fbbf24);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: greeting-zoom 8s ease-in-out infinite, gradient-shift 3s ease infinite;
            filter: drop-shadow(0 0 15px rgba(0, 245, 255, 0.8));
        }
        .greeting-word:nth-child(1) { animation-delay: 0s; }
        .greeting-word:nth-child(2) { animation-delay: 2s; }
        .greeting-word:nth-child(3) { animation-delay: 4s; }
        .greeting-word:nth-child(4) { animation-delay: 6s; }

        @keyframes greeting-zoom {
            0% { opacity: 0; transform: scale(0.3) rotate(-10deg); }
            10% { opacity: 1; transform: scale(1.2) rotate(2deg); }
            20% { transform: scale(1) rotate(0deg); }
            30% { transform: scale(1.05) rotate(-1deg); }
            40% { opacity: 1; transform: scale(1) rotate(0deg); }
            50% { opacity: 0; transform: scale(0.8) rotate(5deg); }
            100% { opacity: 0; transform: scale(0.3) rotate(-10deg); }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Typing Animation */
        .typing-container {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border: 1px solid rgba(34, 211, 238, 0.3);
            border-radius: 0.5rem;
            padding: 0.4rem 0.8rem;
            backdrop-filter: blur(10px);
        }

        .typing-text {
            font-family: 'Orbitron', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            color: #00d9ff;
            text-shadow: 0 0 10px rgba(0, 217, 255, 0.5);
        }

        .tech-stack {
            display: inline;
            animation: tech-fade 12s ease-in-out infinite;
            opacity: 0;
        }

        @keyframes tech-fade {
            0%, 100% { opacity: 0; }
            8%, 24% { opacity: 1; }
            32% { opacity: 0; }
        }

        .tech-stack:nth-child(1) { animation-delay: 0s; }
        .tech-stack:nth-child(2) { animation-delay: 1.5s; }
        .tech-stack:nth-child(3) { animation-delay: 3s; }
        .tech-stack:nth-child(4) { animation-delay: 4.5s; }
        .tech-stack:nth-child(5) { animation-delay: 6s; }
        .tech-stack:nth-child(6) { animation-delay: 7.5s; }
        .tech-stack:nth-child(7) { animation-delay: 9s; }
        .tech-stack:nth-child(8) { animation-delay: 10.5s; }

        .cursor-blink {
            animation: blink 0.8s step-end infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Info Chip */
        .info-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.25rem 0.6rem;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 9999px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            font-size: 0.65rem;
            white-space: nowrap;
        }
        .info-chip::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            animation: chip-shimmer 3s ease-in-out infinite;
        }
        @keyframes chip-shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .info-chip:hover {
            transform: translateY(-2px) scale(1.05);
            border-color: rgba(0, 255, 255, 0.6);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4), inset 0 0 15px rgba(0, 255, 255, 0.1);
        }
        .info-chip i {
            font-size: 0.75rem;
            color: #00d9ff;
            filter: drop-shadow(0 0 5px rgba(0, 255, 255, 0.8));
        }

        /* Social Media Buttons */
        .social-btn {
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
            animation: social-glow 2.5s ease-in-out infinite;
        }
        .social-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, rgba(255,255,255,0.3), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .social-btn:hover::before { opacity: 1; }
        .social-btn:hover {
            transform: translateY(-3px) scale(1.08);
            animation: social-bounce 0.6s ease-in-out;
        }
        .social-btn.linkedin:hover {
            box-shadow: 0 0 25px rgba(10, 102, 194, 0.9), inset 0 0 20px rgba(10, 102, 194, 0.4);
            border-color: rgba(10, 102, 194, 0.8) !important;
        }
        .social-btn.instagram:hover {
            box-shadow: 0 0 25px rgba(225, 48, 108, 0.9), inset 0 0 20px rgba(225, 48, 108, 0.4);
            border-color: rgba(225, 48, 108, 0.8) !important;
        }
        .social-btn.github:hover {
            box-shadow: 0 0 25px rgba(88, 166, 255, 0.9), inset 0 0 20px rgba(88, 166, 255, 0.4);
            border-color: rgba(88, 166, 255, 0.8) !important;
        }

        @keyframes social-glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.15); }
        }

        @keyframes social-bounce {
            0%, 100% { transform: translateY(-3px) scale(1.08); }
            50% { transform: translateY(-5px) scale(1.1); }
        }

        /* Email Chip */
        .email-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.35rem 0.8rem;
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.12) 0%, rgba(249, 115, 22, 0.12) 100%);
            border: 1px solid rgba(236, 72, 153, 0.4);
            border-radius: 9999px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .email-chip::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(236, 72, 153, 0.15), transparent);
            transform: translateX(-100%) skewX(-15deg);
            transition: transform 0.6s;
        }
        .email-chip:hover::after { transform: translateX(100%) skewX(-15deg); }
        .email-chip:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(236, 72, 153, 0.6), inset 0 0 20px rgba(236, 72, 153, 0.2);
            border-color: rgba(236, 72, 153, 0.7);
        }
        .email-chip i {
            color: #ec4899;
            filter: drop-shadow(0 0 5px rgba(236, 72, 153, 0.8));
        }

        /* Subdomain Button */
        .subdomain-btn {
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
            animation: subdomain-pulse 3s ease-in-out infinite;
        }
        .subdomain-btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }
        .subdomain-btn:hover::after { transform: translateX(100%); }
        .subdomain-btn:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 0 35px rgba(34, 211, 238, 0.8), inset 0 0 25px rgba(34, 211, 238, 0.25);
            border-color: rgba(34, 211, 238, 0.8) !important;
        }

        @keyframes subdomain-pulse {
            0%, 100% { box-shadow: 0 0 15px rgba(34, 211, 238, 0.3); }
            50% { box-shadow: 0 0 30px rgba(34, 211, 238, 0.6); }
        }

        /* Enter Universe Button */
        .universe-btn {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.25), rgba(236, 72, 153, 0.25));
            border: 2px solid rgba(249, 115, 22, 0.6);
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            animation: btn-pulse 3s ease-in-out infinite, rainbow-border 4s linear infinite;
        }
        .universe-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.25), transparent);
            transform: translateX(-100%) skewX(-15deg);
            transition: transform 0.6s;
        }
        .universe-btn::after {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #ff00ff, #00ffff, #ff00ff, #00ffff);
            background-size: 400% 400%;
            border-radius: 0.5rem;
            z-index: -1;
            opacity: 0;
            animation: gradient-rotate 3s linear infinite;
            transition: opacity 0.3s;
        }
        .universe-btn:hover::before { transform: translateX(100%) skewX(-15deg); }
        .universe-btn:hover::after { opacity: 0.5; }
        .universe-btn:hover {
            transform: scale(1.07);
            box-shadow: 0 0 45px rgba(249, 115, 22, 0.9), inset 0 0 30px rgba(249, 115, 22, 0.35), 0 0 60px rgba(0, 255, 255, 0.5);
            border-color: rgba(249, 115, 22, 0.9);
        }

        @keyframes btn-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(249, 115, 22, 0.4); }
            50% { box-shadow: 0 0 40px rgba(249, 115, 22, 0.7), 0 0 60px rgba(236, 72, 153, 0.5); }
        }

        @keyframes rainbow-border {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        @keyframes gradient-rotate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Mute Button */
        .mute-btn {
            transition: all 0.3s ease;
        }
        .mute-btn:hover {
            transform: rotate(180deg) scale(1.15);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.6);
        }
        .mute-btn.muted {
            opacity: 0.5;
        }

        /* Back Button */
        .back-btn {
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .back-btn:hover {
            transform: translateX(-5px);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        /* Floating particles */
        @keyframes float {
            0%, 100% { transform: translateY(0px) translateX(0px); opacity: 0.3; }
            50% { transform: translateY(-20px) translateX(10px); opacity: 0.6; }
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.8), transparent);
            border-radius: 50%;
            animation: float 4s ease-in-out infinite;
            pointer-events: none;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .glitch { font-size: 2rem !important; }
            .greeting-word { font-size: 0.85rem !important; }
            .info-chip { font-size: 0.6rem !important; padding: 0.2rem 0.5rem !important; }
            .typing-text { font-size: 0.65rem !important; }
            .social-btn { padding: 0.4rem !important; }
            .construction-banner { padding: 0.3rem !important; font-size: 0.7rem !important; }
        }
    </style>
</head>
<body class="antialiased text-white selection:bg-cyan-500 selection:text-black">

    <div id="canvas-container" class="absolute inset-0 z-0 bg-black cursor-move"></div>

    <main id="ui-layer" class="ui-transition relative z-10 flex flex-col items-center justify-center h-screen w-full px-2 py-1 pointer-events-none overflow-hidden">

        <div class="pointer-events-auto bg-black/75 backdrop-blur-xl border border-white/10 p-1.5 md:p-2 rounded-lg max-w-5xl w-full shadow-2xl relative overflow-hidden">

            <div class="scanline"></div>

            <!-- Floating Particles -->
            <div class="particle" style="top: 10%; left: 15%; animation-delay: 0s;"></div>
            <div class="particle" style="top: 30%; right: 20%; animation-delay: 1s;"></div>
            <div class="particle" style="bottom: 20%; left: 25%; animation-delay: 2s;"></div>
            <div class="particle" style="top: 60%; right: 15%; animation-delay: 3s;"></div>
            <div class="particle" style="top: 25%; left: 45%; animation-delay: 1.5s; background: radial-gradient(circle, rgba(168, 85, 247, 0.8), transparent);"></div>
            <div class="particle" style="top: 75%; right: 35%; animation-delay: 2.5s; background: radial-gradient(circle, rgba(236, 72, 153, 0.8), transparent);"></div>
            <div class="particle" style="bottom: 35%; left: 10%; animation-delay: 0.5s; background: radial-gradient(circle, rgba(34, 211, 238, 0.8), transparent);"></div>
            <div class="particle" style="top: 50%; right: 8%; animation-delay: 3.5s; background: radial-gradient(circle, rgba(249, 115, 22, 0.8), transparent);"></div>

            <!-- Construction Banner with v1.6 -->
            <div class="construction-banner rounded px-3 py-1.5 mb-1 backdrop-blur-sm">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="construction-icon text-base">üöß</span>
                        <span class="gear-spin text-base">‚öôÔ∏è</span>
                        <p class="font-['Rajdhani'] text-orange-300 text-xs font-bold tracking-wider uppercase">
                            Work in Progress
                        </p>
                    </div>
                    <div class="font-['Orbitron'] text-orange-400 text-xs font-bold">v1.6</div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-1.5 md:gap-2">

                <!-- Left Column: Main Info -->
                <div class="space-y-0.5">

                    <!-- Name -->
                    <h1 class="glitch text-3xl md:text-5xl font-black tracking-tighter font-['Orbitron'] text-center mb-0.5" data-text="FARES KHIARY">
                        FARES KHIARY
                    </h1>

                    <!-- Greetings -->
                    <div class="relative h-10 md:h-12 flex items-center justify-center mb-0.5">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="greeting-word">Bonjour</span>
                            <span class="greeting-word">ŸÖÿ±ÿ≠ÿ®ÿß</span>
                            <span class="greeting-word">Hello</span>
                            <span class="greeting-word">Hallo</span>
                        </div>
                    </div>

                    <!-- Typing Animation - Web Developer + Tech Stacks -->
                    <div class="flex justify-center mb-1">
                        <div class="typing-container">
                            <i class="fas fa-code text-cyan-400 text-xs"></i>
                            <div class="typing-text">
                                <span>Web Developer ‚Ä¢</span>
                                <span class="tech-stack">JavaScript</span>
                                <span class="tech-stack">PHP</span>
                                <span class="tech-stack">React</span>
                                <span class="tech-stack">Node.js</span>
                                <span class="tech-stack">Docker</span>
                                <span class="tech-stack">AWS</span>
                                <span class="tech-stack">MySQL</span>
                                <span class="tech-stack">Python</span>
                                <span class="cursor-blink">|</span>
                            </div>
                        </div>
                    </div>

                    <!-- Personal Info - Inline Chips -->
                    <div class="flex flex-wrap items-center justify-center gap-1 mb-1">
                        <div class="info-chip">
                            <i class="fas fa-birthday-cake"></i>
                            <span class="font-['Rajdhani'] font-semibold">32</span>
                        </div>
                        <div class="info-chip">
                            <i class="fas fa-map-marker-alt"></i>
                            <span class="font-['Rajdhani'] font-semibold">Paris üá´üá∑</span>
                        </div>
                        <div class="info-chip">
                            <i class="fas fa-home"></i>
                            <span class="font-['Rajdhani'] font-semibold">üá¥üá≤ Oman</span>
                        </div>
                        <div class="info-chip">
                            <i class="fas fa-flag"></i>
                            <span class="font-['Rajdhani'] font-semibold">üáπüá≥ Tunisia</span>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="flex justify-center mb-1">
                        <a href="mailto:contact@fares-khiary.com" class="email-chip">
                            <i class="fas fa-envelope text-xs"></i>
                            <span class="font-['Rajdhani'] font-semibold text-[11px] text-pink-200">contact@fares-khiary.com</span>
                        </a>
                    </div>

                    <!-- Social Media Section -->
                    <div class="border-t border-white/10 pt-1">
                        <h2 class="font-['Orbitron'] text-cyan-300 text-[10px] font-bold tracking-wider uppercase mb-1 text-center flex items-center justify-center gap-1">
                            <i class="fas fa-share-nodes text-[8px]"></i>
                            <span>Connect</span>
                        </h2>
                        <div class="flex gap-1.5 justify-center">
                            <a href="https://www.linkedin.com/in/fares-khiary" target="_blank" rel="noopener noreferrer"
                               class="social-btn linkedin flex items-center justify-center gap-1 px-2 py-1.5 bg-gradient-to-r from-blue-900/40 to-blue-700/40 border border-blue-500/50 rounded-lg cursor-pointer group">
                                <i class="fab fa-linkedin text-base group-hover:scale-110 transition-transform"></i>
                                <span class="font-['Rajdhani'] text-[9px] font-bold hidden sm:inline">LinkedIn</span>
                            </a>

                            <a href="https://www.instagram.com/khiary.fares" target="_blank" rel="noopener noreferrer"
                               class="social-btn instagram flex items-center justify-center gap-1 px-2 py-1.5 bg-gradient-to-r from-pink-900/40 to-purple-900/40 border border-pink-500/50 rounded-lg cursor-pointer group">
                                <i class="fab fa-instagram text-base group-hover:scale-110 transition-transform"></i>
                                <span class="font-['Rajdhani'] text-[9px] font-bold hidden sm:inline">Instagram</span>
                            </a>

                            <a href="https://github.com/faresk93" target="_blank" rel="noopener noreferrer"
                               class="social-btn github flex items-center justify-center gap-1 px-2 py-1.5 bg-gradient-to-r from-gray-900/40 to-gray-700/40 border border-gray-500/50 rounded-lg cursor-pointer group">
                                <i class="fab fa-github text-base group-hover:scale-110 transition-transform"></i>
                                <span class="font-['Rajdhani'] text-[9px] font-bold hidden sm:inline">GitHub</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Subdomains & Universe -->
                <div class="space-y-1 flex flex-col justify-center">

                    <div class="text-center">
                        <p class="font-['Rajdhani'] text-gray-300 text-xs md:text-sm font-medium leading-relaxed">
                            <span class="text-cyan-400">üåü</span> Explore My Digital Universe <span class="text-cyan-400">üåü</span>
                        </p>
                    </div>

                    <!-- n8n Button -->
                    <button id="n8n-btn" class="subdomain-btn flex items-center justify-center gap-2 px-3 py-2.5 bg-gradient-to-r from-cyan-900/40 to-blue-900/40 border border-cyan-500/50 rounded-lg font-['Orbitron'] text-[10px] font-bold tracking-wide cursor-pointer group">
                        <svg class="w-6 h-6 group-hover:rotate-180 transition-transform duration-500" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="20" y="20" width="60" height="60" rx="8" fill="#EA4B71"/>
                            <rect x="120" y="20" width="60" height="60" rx="8" fill="#EA4B71"/>
                            <rect x="20" y="120" width="60" height="60" rx="8" fill="#EA4B71"/>
                            <rect x="120" y="120" width="60" height="60" rx="8" fill="#EA4B71"/>
                            <path d="M80 50 L120 50 M50 80 L50 120 M150 80 L150 120 M80 150 L120 150" stroke="#EA4B71" stroke-width="8" stroke-linecap="round"/>
                        </svg>
                        <span class="group-hover:text-cyan-300 transition-colors">n8n Automation</span>
                    </button>

                    <!-- Enter My Universe Button -->
                    <button id="start-btn"
                       class="universe-btn relative inline-flex items-center justify-center px-4 py-2.5 font-bold text-white cursor-pointer group uppercase font-['Orbitron'] text-xs tracking-widest rounded-lg">
                        <span class="relative z-10 mr-1.5 text-lg">üåå</span>
                        <span class="relative z-10">Enter My Universe</span>
                        <svg class="relative z-10 w-3.5 h-3.5 ml-1.5 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" /></svg>
                    </button>

                </div>
            </div>
        </div>
    </main>

    <!-- Mute Button -->
    <button id="mute-btn" class="mute-btn fixed top-2 left-2 z-30 w-10 h-10 rounded-full bg-black/60 backdrop-blur-md border border-white/20 flex items-center justify-center cursor-pointer hover:bg-black/80 pointer-events-auto">
        <svg class="w-5 h-5" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="50" r="45" fill="url(#blackhole-gradient)"/>
            <circle cx="50" cy="50" r="15" fill="#000000"/>
            <circle cx="50" cy="50" r="25" fill="none" stroke="#9333EA" stroke-width="2" opacity="0.6"/>
            <circle cx="50" cy="50" r="35" fill="none" stroke="#A855F7" stroke-width="1.5" opacity="0.4"/>
            <defs>
                <radialGradient id="blackhole-gradient">
                    <stop offset="0%" stop-color="#000000"/>
                    <stop offset="40%" stop-color="#1a1a2e"/>
                    <stop offset="70%" stop-color="#6B21A8"/>
                    <stop offset="100%" stop-color="#C084FC"/>
                </radialGradient>
            </defs>
        </svg>
    </button>

    <!-- Back Button -->
    <button id="back-btn" class="back-btn fixed top-2 left-14 z-30 hidden px-3 py-1.5 rounded-lg bg-black/60 backdrop-blur-md border border-white/20 items-center gap-1.5 cursor-pointer hover:bg-black/80 pointer-events-auto font-['Orbitron'] text-[10px] font-bold tracking-wider">
        <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span>BACK</span>
    </button>

    <div id="interactive-hint" class="fixed bottom-4 w-full text-center pointer-events-none z-20">
        <p class="font-['Rajdhani'] text-cyan-300 text-xs tracking-[0.2em] uppercase drop-shadow-md bg-black/50 inline-block px-3 py-1 rounded-full border border-cyan-500/30">
            üñ±Ô∏è Drag ‚Ä¢ Scroll ‚Ä¢ Explore
        </p>
    </div>

    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

        // --- SETUP ---
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x000000, 0.0012);

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 2000);
        camera.position.set(0, 20, 100);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // --- TEXTURE GENERATOR ---
        const createTexture = (type) => {
            const canvas = document.createElement('canvas');
            canvas.width = 512; canvas.height = 512;
            const ctx = canvas.getContext('2d');

            if(type === 'sun') {
                const grd = ctx.createRadialGradient(256,256,0, 256,256,256);
                grd.addColorStop(0, "#ffffff");
                grd.addColorStop(0.2, "#fffacd");
                grd.addColorStop(0.4, "#ffff00");
                grd.addColorStop(0.6, "#ffaa00");
                grd.addColorStop(0.8, "#ff8800");
                grd.addColorStop(1, "#ff4400");
                ctx.fillStyle = grd; ctx.fillRect(0,0,512,512);

                // Add "Web" text to sun
                ctx.fillStyle = "#ffffff";
                ctx.font = "bold 120px Arial";
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                ctx.shadowColor = "#000000";
                ctx.shadowBlur = 10;
                ctx.fillText("Web", 256, 256);
            } else if (type === 'planet') {
                const grd = ctx.createRadialGradient(256,256,150, 256,256,300);
                grd.addColorStop(0, "rgba(255,255,255,0.4)");
                grd.addColorStop(1, "rgba(0,0,0,0.6)");
                ctx.fillStyle = grd; ctx.fillRect(0,0,512,512);

                for(let i=0; i<120; i++) {
                    ctx.fillStyle = `rgba(${100+Math.random()*155}, ${100+Math.random()*155}, ${100+Math.random()*155}, 0.2)`;
                    ctx.beginPath();
                    ctx.arc(Math.random()*512, Math.random()*512, Math.random()*50, 0, Math.PI*2);
                    ctx.fill();
                }
            } else if (type === 'particle') {
                const grd = ctx.createRadialGradient(256,256,0, 256,256,256);
                grd.addColorStop(0, "rgba(255,255,255,1)");
                grd.addColorStop(0.5, "rgba(255,255,200,0.5)");
                grd.addColorStop(1, "rgba(0,0,0,0)");
                ctx.fillStyle = grd; ctx.fillRect(0,0,512,512);
            }
            return new THREE.CanvasTexture(canvas);
        };

        // Create planet textures with tech labels
        const createPlanetTexture = (label, color) => {
            const canvas = document.createElement('canvas');
            canvas.width = 512; canvas.height = 512;
            const ctx = canvas.getContext('2d');

            // Planet surface
            const grd = ctx.createRadialGradient(256,256,150, 256,256,300);
            grd.addColorStop(0, `rgba(${color[0]},${color[1]},${color[2]},0.5)`);
            grd.addColorStop(1, "rgba(0,0,0,0.7)");
            ctx.fillStyle = grd; ctx.fillRect(0,0,512,512);

            // Surface details
            for(let i=0; i<100; i++) {
                ctx.fillStyle = `rgba(${color[0]+Math.random()*50}, ${color[1]+Math.random()*50}, ${color[2]+Math.random()*50}, 0.2)`;
                ctx.beginPath();
                ctx.arc(Math.random()*512, Math.random()*512, Math.random()*40, 0, Math.PI*2);
                ctx.fill();
            }

            return new THREE.CanvasTexture(canvas);
        };

        // Create sprite label for planets
        const createSpriteLabel = (text, color) => {
            const canvas = document.createElement('canvas');
            canvas.width = 256;
            canvas.height = 128;
            const ctx = canvas.getContext('2d');

            // Background with rounded rectangle
            ctx.fillStyle = `rgba(0, 0, 0, 0.7)`;
            ctx.beginPath();
            ctx.roundRect(10, 30, 236, 68, 15);
            ctx.fill();

            // Border with color
            ctx.strokeStyle = `rgba(${color[0]}, ${color[1]}, ${color[2]}, 0.8)`;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.roundRect(10, 30, 236, 68, 15);
            ctx.stroke();

            // Text
            ctx.fillStyle = "#ffffff";
            ctx.font = "bold 42px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.shadowColor = `rgba(${color[0]}, ${color[1]}, ${color[2]}, 0.9)`;
            ctx.shadowBlur = 15;
            ctx.fillText(text, 128, 64);

            const texture = new THREE.CanvasTexture(canvas);
            const spriteMaterial = new THREE.SpriteMaterial({
                map: texture,
                transparent: true,
                opacity: 0.95
            });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.scale.set(8, 4, 1);

            return sprite;
        };

        // --- SOLAR SYSTEM ---
        const solarSystem = new THREE.Group();
        scene.add(solarSystem);

        // Enhanced Sun with "Web" label
        const sunGeo = new THREE.SphereGeometry(12, 64, 64);
        const sunMat = new THREE.MeshBasicMaterial({
            map: createTexture('sun'),
            emissive: 0xffaa00,
            emissiveIntensity: 0.9
        });
        const sun = new THREE.Mesh(sunGeo, sunMat);
        solarSystem.add(sun);

        // Multi-layered Sun Glow
        for(let i = 0; i < 3; i++) {
            const glowMat = new THREE.SpriteMaterial({
                map: createTexture('particle'),
                color: i === 0 ? 0xffff00 : (i === 1 ? 0xffaa00 : 0xff6600),
                transparent: true,
                opacity: 0.7 - (i * 0.15),
                blending: THREE.AdditiveBlending
            });
            const glow = new THREE.Sprite(glowMat);
            glow.scale.set(75 + (i * 25), 75 + (i * 25), 1);
            solarSystem.add(glow);
        }

        // Enhanced Lighting
        const pointLight = new THREE.PointLight(0xffffdd, 5, 550);
        solarSystem.add(pointLight);
        scene.add(new THREE.AmbientLight(0x606060));

        // Planets with tech labels
        const planets = [];
        const techLabels = ['JS', 'PHP', 'DB', 'AI', 'React', 'Node', 'AWS', 'Docker'];
        const planetColors = [
            [220, 180, 100],  // JS - golden
            [100, 100, 220],  // PHP - purple
            [50, 150, 220],   // DB - blue
            [220, 50, 150],   // AI - magenta
            [100, 220, 250],  // React - cyan
            [100, 200, 100],  // Node - green
            [255, 153, 0],    // AWS - orange
            [100, 180, 220]   // Docker - blue
        ];

        const createPlanet = (size, dist, speed, label, color) => {
            const mesh = new THREE.Mesh(
                new THREE.SphereGeometry(size, 32, 32),
                new THREE.MeshStandardMaterial({
                    map: createPlanetTexture(label, color),
                    roughness: 0.4,
                    metalness: 0.4,
                    emissive: new THREE.Color(color[0]/255, color[1]/255, color[2]/255),
                    emissiveIntensity: 0.3
                })
            );
            const angle = Math.random() * Math.PI * 2;
            mesh.position.set(Math.cos(angle) * dist, 0, Math.sin(angle) * dist);

            // Enhanced orbit rings
            const ringGeo = new THREE.RingGeometry(dist-0.3, dist+0.3, 128);
            const ringMat = new THREE.MeshBasicMaterial({
                color: new THREE.Color(color[0]/255, color[1]/255, color[2]/255),
                side: THREE.DoubleSide,
                transparent: true,
                opacity: 0.2
            });
            const ring = new THREE.Mesh(ringGeo, ringMat);
            ring.rotation.x = Math.PI/2;
            solarSystem.add(ring);

            // Add sprite label
            const spriteLabel = createSpriteLabel(label, color);
            spriteLabel.position.copy(mesh.position);
            spriteLabel.position.y += size + 3;
            solarSystem.add(spriteLabel);

            solarSystem.add(mesh);
            return { mesh, dist, speed, angle, label: spriteLabel, size };
        };

        // Create planets with tech labels
        const distances = [25, 35, 45, 55, 75, 95, 115, 130];
        const speeds = [0.8, 0.6, 0.5, 0.4, 0.2, 0.15, 0.1, 0.08];
        const sizes = [1.5, 2.5, 2.8, 2, 6, 5, 3.5, 3.5];

        for(let i = 0; i < 8; i++) {
            planets.push(createPlanet(sizes[i], distances[i], speeds[i], techLabels[i], planetColors[i]));
        }

        // Asteroid Belt
        const asteroidGeo = new THREE.TetrahedronGeometry(0.5, 0);
        const asteroidMat = new THREE.MeshStandardMaterial({
            color: 0xaaaaaa,
            roughness: 0.9,
            metalness: 0.1,
            emissive: 0x444444,
            emissiveIntensity: 0.15
        });
        const asteroids = new THREE.InstancedMesh(asteroidGeo, asteroidMat, 2000);
        const dummy = new THREE.Object3D();

        for(let i=0; i<2000; i++) {
            const r = 60 + Math.random() * 20;
            const theta = Math.random() * Math.PI * 2;
            const y = (Math.random() - 0.5) * 12;

            dummy.position.set(r * Math.cos(theta), y, r * Math.sin(theta));
            dummy.rotation.set(Math.random(), Math.random(), Math.random());
            dummy.scale.setScalar(Math.random() * 2.5);
            dummy.updateMatrix();
            asteroids.setMatrixAt(i, dummy.matrix);
        }
        solarSystem.add(asteroids);

        // Enhanced Starfield
        const starsGeo = new THREE.BufferGeometry();
        const starsPos = [];
        const starsColors = [];
        const starsSizes = [];

        for(let i=0; i<10000; i++) {
            starsPos.push(
                (Math.random()-0.5)*2000,
                (Math.random()-0.5)*2000,
                (Math.random()-0.5)*2000
            );

            const colorChoice = Math.random();
            if (colorChoice > 0.8) {
                starsColors.push(0.6 + Math.random()*0.4, 0.7 + Math.random()*0.3, 1.0);
            } else if (colorChoice > 0.5) {
                starsColors.push(1.0, 1.0, 1.0);
            } else if (colorChoice > 0.2) {
                starsColors.push(1.0, 0.9 + Math.random()*0.1, 0.7 + Math.random()*0.2);
            } else {
                starsColors.push(1.0, 0.6 + Math.random()*0.2, 0.5 + Math.random()*0.2);
            }

            starsSizes.push(Math.random() * 4 + 0.3);
        }

        starsGeo.setAttribute('position', new THREE.Float32BufferAttribute(starsPos, 3));
        starsGeo.setAttribute('color', new THREE.Float32BufferAttribute(starsColors, 3));
        starsGeo.setAttribute('size', new THREE.Float32BufferAttribute(starsSizes, 1));

        const stars = new THREE.Points(
            starsGeo,
            new THREE.PointsMaterial({
                size: 2.5,
                vertexColors: true,
                transparent: true,
                opacity: 0.95,
                sizeAttenuation: true
            })
        );
        scene.add(stars);

        // Nebula Clouds - Enhanced
        const nebulaGeo = new THREE.SphereGeometry(350, 32, 32);
        const nebulaMat = new THREE.MeshBasicMaterial({
            color: 0x9333ea,
            transparent: true,
            opacity: 0.1,
            side: THREE.BackSide,
            blending: THREE.AdditiveBlending
        });
        const nebula1 = new THREE.Mesh(nebulaGeo, nebulaMat);
        nebula1.position.set(200, 100, -200);
        scene.add(nebula1);

        const nebula2 = new THREE.Mesh(nebulaGeo.clone(), nebulaMat.clone());
        nebula2.material.color.setHex(0x06b6d4);
        nebula2.position.set(-200, -100, 200);
        scene.add(nebula2);

        const nebula3 = new THREE.Mesh(nebulaGeo.clone(), nebulaMat.clone());
        nebula3.material.color.setHex(0xec4899);
        nebula3.position.set(0, 150, 100);
        scene.add(nebula3);

        // --- INTERACTION ---
        let isDragging = false;
        let isPanning = false;
        let previousMousePosition = { x: 0, y: 0 };
        let state = 'MENU';

        let cameraDistance = 150;
        let cameraOffset = { x: 0, y: 30, z: 0 };
        const minDistance = 30;
        const maxDistance = 300;

        const handleStart = (x, y, button = 0, shiftKey = false) => {
            if (button === 2 || shiftKey) {
                isPanning = true;
            } else {
                isDragging = true;
            }
            previousMousePosition = { x, y };
        };

        const handleMove = (x, y) => {
            const deltaMove = {
                x: x - previousMousePosition.x,
                y: y - previousMousePosition.y
            };

            if (isPanning && state === 'UNLOCKED') {
                const panSpeed = 0.3;
                cameraOffset.x -= deltaMove.x * panSpeed;
                cameraOffset.y += deltaMove.y * panSpeed;
            } else if (isDragging && state === 'UNLOCKED') {
                const rotateSpeed = 0.005;
                solarSystem.rotation.y += deltaMove.x * rotateSpeed;
                solarSystem.rotation.x += deltaMove.y * rotateSpeed;
            }

            previousMousePosition = { x, y };
        };

        const handleEnd = () => {
            isDragging = false;
            isPanning = false;
        };

        const handleWheel = (e) => {
            if (state === 'UNLOCKED') {
                e.preventDefault();
                const zoomSpeed = 0.1;
                cameraDistance += e.deltaY * zoomSpeed;
                cameraDistance = Math.max(minDistance, Math.min(maxDistance, cameraDistance));
            }
        };

        document.addEventListener('mousedown', e => handleStart(e.clientX, e.clientY, e.button, e.shiftKey));
        document.addEventListener('touchstart', e => handleStart(e.touches[0].clientX, e.touches[0].clientY), {passive: false});
        document.addEventListener('mousemove', e => handleMove(e.clientX, e.clientY));
        document.addEventListener('touchmove', e => {
            e.preventDefault();
            handleMove(e.touches[0].clientX, e.touches[0].clientY);
        }, {passive: false});
        document.addEventListener('mouseup', handleEnd);
        document.addEventListener('touchend', handleEnd);
        document.addEventListener('wheel', handleWheel, {passive: false});
        document.addEventListener('contextmenu', e => {
            if (state === 'UNLOCKED') e.preventDefault();
        });

        // --- ENHANCED AUDIO WITH SHOOTING STARS & SPACECRAFT ---
        let audioContext;
        let masterGain;
        let oscillators = [];
        let noiseNode = null;
        let isMuted = false;
        let isAudioInitialized = false;

        const muteBtn = document.getElementById('mute-btn');

        const initAudio = async () => {
            if (isAudioInitialized) return;

            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();

                // Ensure audio context is running
                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                }

                masterGain = audioContext.createGain();
                masterGain.connect(audioContext.destination);
                masterGain.gain.setValueAtTime(0, audioContext.currentTime);
                masterGain.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + 2);

                // Base ambient frequencies
                const frequencies = [55, 73, 110, 147, 220];

                frequencies.forEach((freq, index) => {
                    const osc = audioContext.createOscillator();
                    const gain = audioContext.createGain();

                    osc.type = 'sine';
                    osc.frequency.value = freq;
                    gain.gain.value = 0.08 / (index + 1);

                    osc.connect(gain);
                    gain.connect(masterGain);
                    osc.start(audioContext.currentTime);
                    oscillators.push({ osc, gain });

                    const lfo = audioContext.createOscillator();
                    lfo.frequency.value = 0.08 + (index * 0.04);
                    const lfoGain = audioContext.createGain();
                    lfoGain.gain.value = 1.5 + (index * 0.3);

                    lfo.connect(lfoGain);
                    lfoGain.connect(osc.frequency);
                    lfo.start(audioContext.currentTime);
                });

                // White noise
                const bufferSize = 4096;
                noiseNode = audioContext.createScriptProcessor(bufferSize, 1, 1);
                noiseNode.onaudioprocess = (e) => {
                    const output = e.outputBuffer.getChannelData(0);
                    for (let i = 0; i < bufferSize; i++) {
                        output[i] = (Math.random() * 2 - 1) * 0.015;
                    }
                };

                const noiseFilter = audioContext.createBiquadFilter();
                noiseFilter.type = 'lowpass';
                noiseFilter.frequency.value = 350;

                noiseNode.connect(noiseFilter);
                noiseFilter.connect(masterGain);

                // Shooting star sound effect (periodic high-pitched sweep)
                setInterval(() => {
                    if (!isMuted && audioContext && audioContext.state === 'running') {
                        try {
                            const shootingStar = audioContext.createOscillator();
                            const shootingGain = audioContext.createGain();

                            shootingStar.type = 'sine';
                            shootingStar.frequency.setValueAtTime(1200, audioContext.currentTime);
                            shootingStar.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.5);

                            shootingGain.gain.setValueAtTime(0, audioContext.currentTime);
                            shootingGain.gain.linearRampToValueAtTime(0.03, audioContext.currentTime + 0.05);
                            shootingGain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);

                            shootingStar.connect(shootingGain);
                            shootingGain.connect(masterGain);
                            shootingStar.start(audioContext.currentTime);
                            shootingStar.stop(audioContext.currentTime + 0.5);
                        } catch (e) {
                            console.warn('Shooting star sound failed:', e);
                        }
                    }
                }, 8000 + Math.random() * 4000); // Random interval between 8-12 seconds

                // Spacecraft whoosh sound (periodic)
                setInterval(() => {
                    if (!isMuted && audioContext && audioContext.state === 'running') {
                        try {
                            const spacecraft = audioContext.createOscillator();
                            const spacecraftGain = audioContext.createGain();
                            const spacecraftFilter = audioContext.createBiquadFilter();

                            spacecraft.type = 'sawtooth';
                            spacecraft.frequency.setValueAtTime(80, audioContext.currentTime);
                            spacecraft.frequency.linearRampToValueAtTime(120, audioContext.currentTime + 1.5);

                            spacecraftFilter.type = 'lowpass';
                            spacecraftFilter.frequency.setValueAtTime(400, audioContext.currentTime);
                            spacecraftFilter.frequency.linearRampToValueAtTime(800, audioContext.currentTime + 1.5);

                            spacecraftGain.gain.setValueAtTime(0, audioContext.currentTime);
                            spacecraftGain.gain.linearRampToValueAtTime(0.02, audioContext.currentTime + 0.3);
                            spacecraftGain.gain.linearRampToValueAtTime(0.02, audioContext.currentTime + 1.2);
                            spacecraftGain.gain.linearRampToValueAtTime(0, audioContext.currentTime + 1.5);

                            spacecraft.connect(spacecraftFilter);
                            spacecraftFilter.connect(spacecraftGain);
                            spacecraftGain.connect(masterGain);
                            spacecraft.start(audioContext.currentTime);
                            spacecraft.stop(audioContext.currentTime + 1.5);
                        } catch (e) {
                            console.warn('Spacecraft sound failed:', e);
                        }
                    }
                }, 15000 + Math.random() * 10000); // Random interval between 15-25 seconds

                isAudioInitialized = true;
                console.log('‚úÖ Audio initialized with space effects. State:', audioContext.state);

                // Force resume if still suspended
                if (audioContext.state !== 'running') {
                    await audioContext.resume();
                    console.log('üîä Audio context resumed. New state:', audioContext.state);
                }
            } catch (error) {
                console.error('‚ùå Audio initialization failed:', error);
            }
        };

        muteBtn.addEventListener('click', async () => {
            if (!isAudioInitialized) {
                await initAudio();
            }

            if (audioContext && audioContext.state === 'suspended') {
                await audioContext.resume();
            }

            isMuted = !isMuted;
            if (audioContext && masterGain) {
                masterGain.gain.setValueAtTime(masterGain.gain.value, audioContext.currentTime);
                masterGain.gain.linearRampToValueAtTime(isMuted ? 0 : 0.15, audioContext.currentTime + 0.5);
            }
            muteBtn.classList.toggle('muted', isMuted);
        });

        const startAudio = async () => {
            if (!isAudioInitialized && !isMuted) {
                await initAudio();
            }
            if (audioContext && audioContext.state === 'suspended') {
                await audioContext.resume();
            }
        };

        // Buttons
        document.getElementById('n8n-btn').addEventListener('click', () => {
            startAudio();
            window.open('https://n8n.fares-khiary.com', '_blank');
        });

        document.getElementById('start-btn').addEventListener('click', () => {
            state = 'UNLOCKED';
            document.getElementById('ui-layer').classList.add('fade-out');
            document.getElementById('interactive-hint').classList.add('show-hint');
            document.getElementById('back-btn').classList.remove('hidden');
            document.getElementById('back-btn').classList.add('flex');
            startAudio();
        });

        document.getElementById('back-btn').addEventListener('click', () => {
            state = 'MENU';
            document.getElementById('ui-layer').classList.remove('fade-out');
            document.getElementById('interactive-hint').classList.remove('show-hint');
            document.getElementById('back-btn').classList.add('hidden');
            document.getElementById('back-btn').classList.remove('flex');
            cameraDistance = 150;
            cameraOffset = { x: 0, y: 30, z: 0 };
            solarSystem.rotation.set(0, 0, 0);
        });

        // Auto-start audio on first user interaction
        const autoStartAudio = async () => {
            console.log('üéµ User interaction detected, starting audio...');
            await startAudio();
            // Remove listeners after first successful init
            if (isAudioInitialized) {
                ['click', 'touchstart', 'keydown'].forEach(event => {
                    document.removeEventListener(event, autoStartAudio);
                });
            }
        };

        const events = ['click', 'touchstart', 'keydown'];
        events.forEach(event => {
            document.addEventListener(event, autoStartAudio, { once: true });
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- ANIMATION LOOP ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);
            const delta = clock.getDelta();
            const time = clock.getElapsedTime();

            // Rotate Planets and update labels
            planets.forEach(p => {
                p.angle += p.speed * delta;
                p.mesh.position.x = Math.cos(p.angle) * p.dist;
                p.mesh.position.z = Math.sin(p.angle) * p.dist;
                p.mesh.rotation.y += delta * 0.3;

                // Update label position to follow planet
                p.label.position.x = p.mesh.position.x;
                p.label.position.z = p.mesh.position.z;
                p.label.position.y = p.mesh.position.y + p.size + 3;
            });

            asteroids.rotation.y += 0.015 * delta;

            const pulse = 1 + Math.sin(time * 2) * 0.07;
            sun.scale.setScalar(pulse);

            stars.rotation.y += 0.0001;
            stars.rotation.x += 0.00004;

            const twinkle = 0.85 + Math.sin(time * 0.7) * 0.15;
            stars.material.opacity = twinkle;

            nebula1.rotation.y += 0.00012;
            nebula1.rotation.z += 0.00006;
            nebula2.rotation.y -= 0.0001;
            nebula2.rotation.z -= 0.00007;
            nebula3.rotation.y += 0.00008;
            nebula3.rotation.z -= 0.00005;

            if (state === 'MENU') {
                camera.position.x = Math.sin(time * 0.15) * 25;
                camera.position.y = 20 + Math.cos(time * 0.15) * 12;
                camera.position.z = 100 + Math.sin(time * 0.1) * 10;
                camera.lookAt(0, 0, 0);
            } else {
                const targetPos = new THREE.Vector3(
                    cameraOffset.x,
                    cameraOffset.y,
                    cameraDistance
                );
                camera.position.lerp(targetPos, 0.1);
                camera.lookAt(0, 0, 0);
            }

            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>
